<script type="text/javascript">
    RED.nodes.registerType('odata client', {
        category: 'odata',
        color: '#d24714',
        defaults: {
            name: { value: "" },
            method: { value: "GET" },
            rootURL: { value: "" },
            resource: { value: "$metadata" },
            querytop: { value: "" },
            queryskip: { value: "" },
            queryfilter: { value: "" },
            queryorderby: { value: "" },
            queryselect: { value: "" },
            querycount: { value: "" },
            querysearch: { value: "" },
        },
        inputs: 1,
        outputs: 1,
        icon: 'font-awesome/fa-paper-plane-o',
        label: function () {
            return this.name || "odata client";
        },
        oneditprepare: function () {
            $("#node-input-method").on("change", function () {
                if ($("#node-input-method").val() === "GET") {
                    $("#node-input-querytoprow").show();
                    $("#node-input-queryskiprow").show();
                    $("#node-input-queryorderbyrow").show();
                    $("#node-input-queryselectrow").show();
                    $("#node-input-queryfilterrow").show();
                    $("#node-input-querycountrow").show();
                    $("#node-input-querysearchrow").show();
                    $("#node-input-instructionspanel").hide();
                } else {
                    $("#node-input-querytoprow").hide();
                    $("#node-input-queryskiprow").hide();
                    $("#node-input-queryorderbyrow").hide();
                    $("#node-input-queryselectrow").hide();
                    $("#node-input-queryfilterrow").hide();
                    $("#node-input-querycountrow").hide();
                    $("#node-input-querysearchrow").hide();
                    $("#node-input-instructionspanel").show();
                }
            });
        }
    });
</script>

<script type="text/html" data-template-name="odata client">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name </label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-method"><i class="fa fa-tasks"></i><span> Method </span></label>
        <select type="select" id="node-input-method">
            <option value="GET">GET</option>
            <option value="POST">POST</option>
            <option value="PUT">PUT</option>
            <option value="PATCH">PATCH</option>
            <option value="DELETE">DELETE</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-rootURL"><i class="fa fa-sitemap"></i> Root URL</label>
        <input type="text" id="node-input-rootURL" placeholder="http://my-serviceroot.url/">
    </div>
    <div class="form-row">
        <label for="node-input-resource"><i class="fa fa-table"></i> Resource : </label>
        <input type="text" id="node-input-resource" placeholder="Users or Users('Superman')">
    </div>
    <div class="form-row" id="node-input-querytoprow">
        <label for="node-input-querytop"><i class="fa fa-filter"></i> $top = </label>
        <input type="text" id="node-input-querytop" placeholder="$top = 10">
    </div>
    <div class="form-row" id="node-input-queryskiprow">
        <label for="node-input-queryskip"><i class="fa fa-filter"></i> $skip = </label>
        <input type="text" id="node-input-queryskip" placeholder="$skip = 5">
    </div>
    <div class="form-row" id="node-input-queryorderbyrow">
        <label for="node-input-queryorderby"><i class="fa fa-filter"></i> $orderby = </label>
        <input type="text" id="node-input-queryorderby" placeholder="$orderby = Email">
    </div>
    <div class="form-row" id="node-input-queryselectrow">
        <label for="node-input-queryselect"><i class="fa fa-filter"></i> $select = </label>
        <input type="text" id="node-input-queryselect" placeholder="$select = Name, Email">
    </div>
    <div class="form-row" id="node-input-queryfilterrow">
        <label for="node-input-queryfilter"><i class="fa fa-filter"></i> $filter = </label>
        <input type="text" id="node-input-queryfilter" placeholder="$filter = FirstName eq 'Superman'">
    </div>
    <div class="form-row" id="node-input-querycountrow">
        <label for="node-input-querycount"><i class="fa fa-filter"></i> $count = </label>
        <input type="text" id="node-input-querycount" placeholder="$count = true">
    </div>
    <div class="form-row" id="node-input-querysearchrow">
        <label for="node-input-querysearch"><i class="fa fa-filter"></i> $search = </label>
        <input type="text" id="node-input-querysearch" placeholder="$search = Cyber Group">
    </div>
    <div class="form-row" id="node-input-instructionspanel">
        1. Service Root Url is the base url of your OData Service.
        <br>
        2. Resource field is the name of the entity you want to access
        <br>
        3. If provided, <i style="color:#AD1625;">msg.payload</i> is attached to request as the request body.
        <br>
        4. To Override default headers, use<i style="color:#AD1625;">msg.reqHeaders</i> property.
        <br>
        5. To Override request url, use<i style="color:#AD1625;">msg.reqUrl</i> property.
    </div>
</script>

<script type="text/html" data-help-name="odata client">
    <p>A node that helps you consume odata complaint api</p>
    <div>
        1. Service Root Url is the base url of your OData Service.
        <br>
        2. Resource field is the name of the entity you want to access
        <br>
        3. To Override request url, use<i style="color:#AD1625;">msg.reqUrl</i> property.
        <br>
        4. To Override default headers, use<i style="color:#AD1625;">msg.reqHeaders</i> property.
        <br>
        5. If provided, <i style="color:#AD1625;">msg.payload</i> is attached to request as the request body for PUT POST PATCH requests.
    </div>
</script>